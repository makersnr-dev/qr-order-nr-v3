
<!doctype html><html lang="ko"><meta charset="utf-8"><title>Admin</title>
<body>
  <h1>관리자 콘솔</h1>
  <button id="logout">로그아웃</button>
  <pre id="me"></pre>
  <h2>주문 목록</h2>
  <ul id="orders"></ul>
  <h2>메뉴</h2>
  <ul id="menu"></ul>
  <h2>엑셀 내보내기</h2>
  <a href="/export/orders.xlsx">orders.xlsx 다운로드</a>
  <h2>SSE 이벤트</h2>
  <pre id="events"></pre>
  <script src="/static/admin/helpers.js"></script>
  <script>
    async function init(){
      const me = await apiGet('/api/admin/me');
      if(!me.user){ location.href='/login'; return; }
      document.getElementById('me').textContent = JSON.stringify(me,null,2);
      const orders = await apiGet('/orders');
      document.getElementById('orders').innerHTML = orders.map(o=>`<li>${o.id} - ${o.createdAt}</li>`).join('');
      const menu = await apiGet('/menu');
      document.getElementById('menu').innerHTML = menu.map(m=>`<li>${m.id} ${m.name} ${m.price}</li>`).join('');
      const es = new EventSource('/events/orders', { withCredentials: true });
      es.addEventListener('created', ev => {
        const msg = JSON.parse(ev.data);
        const pre = document.getElementById('events');
        pre.textContent += '\n[created] ' + JSON.stringify(msg);
      });
    }
    document.getElementById('logout').onclick = async ()=>{ await apiPost('/api/admin/logout'); location.href='/login'; };
    init().catch(e=>console.error(e));
  </script>
</body></html>
